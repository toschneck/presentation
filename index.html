<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Containerized End-2-End-Testing</title>

    <meta name="description"
          content="Containerized End-2-End-Testing, more information under https://github.com/ConSol/sakuli ">
    <meta name="author" content="Tobias Schneck">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/sakuli_white.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">
    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <div style="text-align: left"><img src="pics/background_first_slide_top.png"
                                               style="vertical-align:top; width:11em; border: 0;box-shadow: none"/>
            </div>
            <!--<div style="background:url('pics/background_first_slide_top.png'); height:50%; width:50%; overflow:hidden;">-->
            <!--</div>-->
            <h2 style="padding-top: 2em; margin-bottom: 0;text-transform: none">Containerized
                End-2-End-Testing</h2>

            <h2 style="padding-top: 0.2em;">
                <img src="pics/sakuli-logo.png" style="width:5em; border: 0;box-shadow: none" alt="Sakuli">
                +
                <img src="pics/docker-img.jpg" style="width:5em; border: 0;box-shadow: none" alt="Docker">
            </h2>

            <p style="padding-top: 4em; text-align: right">
                <small>Created by <a href="mailto:tobias.schneck@consol.de">Tobias Schneck</a> @ <a
                        href="http://www.consol.de">ConSol*</a>
                </small>
                </br>
            </p>

            <!--<div style="text-align: right; overflow: hidden; ">-->
            <!--<img src="pics/background_first_slide_bottom.png"-->
            <!--style="vertical-align:text-bottom; width:8em; border: 0;box-shadow: none"/>-->
            <!--</div>-->
        </section>


        <section>
            <h2>Motivation</h2>
            <img class="image" width="40%" src="pics/chain.png" style="border: 0">
            <ul>
                <li>Business-kritische Applikationen bestehen oft aus einer Vielzahl an Komponenten</li>
                <li>Applikations-Qualität aus Anwendersicht ist nur am Ende der Funktionskette messbar</li>
                <li>UI-Interfaces sind schwer kontinuierlich zu testen</li>
            </ul>
        </section>

        <section>
            <h2>Testpyramide</h2>
            <img class="image" width="40%" src="pics/test_pyramide.png"
                 style="padding-top: 0.5rem; border: 0; box-shadow: none">
        </section>

        <section>
            <h2>Anforderung an Testumgebungen</h2>
            <ul>
                <li class="coloured"><b>robust</b></li>
                <ul>
                    <li>keine "zufälligen" Fehler</li>
                    <li>Fehler sind reproduzierbar</li>
                </ul>
                <li class="coloured"><b>unabhängig</b></li>
                <ul>
                    <li>möglichst wenig Abhängikeiten zu externen Systemen</li>
                    <li>Umgebung sollte exklusiv zur Verfügung stehen</li>
                </ul>
                <li class="coloured"><b>isoliert</b></li>
                <ul>
                    <li>Tests habe keine Abhängikeit untereinander</li>
                    <li>Tests sollten parallelisierbar sein</li>
                </ul>
                <li class="coloured"><b>schnell</b></li>
                <ul>
                    <li>kurze Laufzeiten mit aussagekräfitgen Feedback</li>
                </ul>
            </ul>
            <aside class="notes">
                Quelle: Roland Huss
            </aside>
        </section>

        <section>
            <h2>Besonderheiten bei End-2-End Tests</h2>
            <ul>
                <li class="coloured">unterschiedliche Testarten:</li>
                <ul>
                    <li>Regressionstests</li>
                    <li>funktionale Abnahmetests</li>
                </ul>
                <li class="coloured">Parallele Tests in GUIs sind schwieriger</li>
                <ul>
                    <li>geteilte Testdaten oder Login-User</li>
                    <li>User-Sessions mit Stati</li>
                    <li>Cleanup von Testdaten</li>
                </ul>
                <li class="coloured">Testumgebung muss möglichst nah an der <br/>End-User-Umgebung</li>
                <li class="coloured">manueller Testaufwand <b>></b> Aufwand für Automatisierung</li>
            </ul>
            <aside class="notes">
                Quelle: Roland Huss
            </aside>
        </section>

        <section>
            <h2>Vorteile der Container-Technologien</h2>
            <h4>Hilfreich für End-End-Testing?</h4>
            <ul class="fragment">
                <li><b>Isolation</b> von Umgebungen</li>
                <li><b>Nachvollziehbarer Aufbau</b> der Umgebung
                    <br/>(z.B. durch Dockerfile)
                </li>
                <li>Container starten <b>on-the-fly</b></li>
                <li>einfache <b>Parallelisierung</b></li>
                <ul>
                    <li>Wenig Speicher-Overhead</li>
                    <li>Teilen den selben Linux-Kernel</li>
                </ul>
            </ul>
        </section>

        <section>
            <h2>Virtuelle Maschinen vs. Container
                <p style="font-size: x-large">(am Beispiel Docker)</p></h2>
            <img width="95%" src="pics/vm_vs_docker.png">
        </section>
        <section>
            <h2>Immutable Filesystem Layers
                <p style="font-size: x-large">(am Beispiel Docker)</p></h2>
            <div style="padding-top: 0.5em;">
                <img width="60%" src="pics/docker-layers.png">
            </div>
        </section>


        <section>
            <h2>Herausforderung</h2>
            <ul>
                <li>Web-UI-Test-Tools haben nur Zugriff auf DOM-Elemente</li>
                <li>Wie kann man Nicht-HTML-Inhalte testen bzw. damit umgehen? =>
                    <b>Flash, PKI-Abfragen, Java Applets, Plugins</b>

                    <div style="text-align: center; "><img class="image" src="pics/java_applet.png"
                                                           style="height: 4.7em; padding-top: 0.1em;"></div>
                </li>
                <li>Grafisch basierte Tests sind ressourcenintensiv</li>
                <li>OS unabhängiges Framework</li>
                <li>UI-Rendering testbar?</li>
            </ul>
            <aside class="notes">
                <ul>
                    <li>Sahi, Selenium, Casperjs, Webinject...</li>
                    <li>AutoIT, Sikuli, Autohotkey, .... Grenzen (fairerweise: ihre natürlichen).</li>
                    <li>zu speziell: blinde Flecken (oder auch PIN-Abfrage!)</li>
                    <li>(teilweise) OS-abhängig: z.b. Auto IT -> WIndows</li>
                    <li>zu generisch: für Web- -> Seitenaufbau (DOM) kennt.</li>
                    <li>Realitätsbezug: Tools die Browsr simulieren -> Rendering-Engine? . D.h. ob die Seite beim User
                        wirklich
                        so aussieht?
                    </li>
                </ul>
            </aside>

            <h3 style="text-transform: none; margin-top: 0.2em" class="fragment">
                Was macht Sakuli?
            </h3>

        </section>

        <section>
            <table style="margin-bottom: 0.5em;">
                <tbody>
                <tr style="padding-bottom: 0.2em">
                    <td width="40%"
                        style="text-align: center; padding:0; background: url(pics/dom.png) no-repeat bottom; background-size: 80%">
                        <img style="border: 0; padding: 0; margin: 0; height: 2em; box-shadow: none"
                             src="pics/sahi.png">
                    </td>
                    <td style="text-align: center"><img
                            style="height: 6em; border: 0; padding: 0; margin: 0; box-shadow: none"
                            src="pics/3maennchen_mit_sakuli.png"></td>
                    <td width="40%"
                        style="text-align: center;padding: 0; background: url(pics/screen_shots.png) no-repeat bottom; background-size: 77%">
                        <img style="border: 0; padding: 0; margin: 0;height: 2em; box-shadow: none"
                             src="pics/sikuli.png">
                    </td>
                </tr>
                </tbody>
            </table>
            <table>
                <tbody>
                <tr style="font-size: 0.9em;">
                    <td width="47%" style="padding: 0; vertical-align: top; font-size: 0.7em">
                        <ul>
                            <li>Aktionsbereich: Browser-Inhalt <br/>(z.b. kein Scrollen notwendig)</li>
                            <li>Objekt-Adressierung von DOM-Elementen</li>
                            <li>Java-API</li>
                            <li>Erkennt wenn Seiten/AJAX-Requests fertig geladen sind</li>
                            <li>Guter Umgang mit AJAX & Web-Frameworks</li>
                            <li>Recorder-Funktionalität</li>
                            <li>Assert Funktionalität</li>
                        </ul>
                        <!--<div class="backgrounds">-->
                        <!--<img src="pics/dom.png" style="opacity: 0.7; border: 0;">-->
                        <!--</div>-->
                    </td>
                    <td style="padding: 10px"></td>
                    <td width="47%" style="padding: 0; vertical-align: top; font-size: 0.7em">
                        <ul>
                            <li>Aktionsbereich:Bildschirm-Inhalt <br/>(Scrollen u.U. notwendig)</li>
                            <li>Objekt-Adressierung über Grafik-Patterns</li>
                            <li>Java-API</li>
                            <li>Keine Beschränkung auf den Browser</li>
                            <li>Sieht und steuert das, was der User sieht</li>
                            <li>Flexible Region-Pattern</li>
                            <li>OCR-Features
                                <small style="vertical-align: baseline">(experimental)</small>
                            </li>
                            <li>Setzt auf <b>java.awt.Robot</b> und <b>openCV</b> auf</li>
                        </ul>
                    </td>
                </tr>
                </tbody>
            </table>
        </section>

        <section>
            <h2>Stärken der Vereinigung</h2>
            <table>
                <tbody>
                <tr>
                    <td width="12%" style="padding: 0;  text-align: center">
                        <img class="image"
                             src="pics/sahi_worker.png" style="height: 3em; border: 0;">
                    </td>
                    <td width="12%" style="padding: 0;  text-align: center">
                        <img class="image"
                             src="pics/sikuli_worker.png" style="height: 3em; border: 0;">
                    </td>
                    <td width="12%" style="padding: 0 0 0.3em 0; text-align: center">
                        <img class="image"
                             src="pics/3maennchen_mit_sakuli.png" style=" height: 3em; border: 0; ">
                    </td>
                    <td style="padding: 0; text-align: center; vertical-align: bottom; border-left: 1px">
                        <h3>Kategorie</h3>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center"><img src="pics/bubble_red.png"
                                                        style="max-height: 45px; margin-bottom: 0.2em; box-shadow: none">
                    </td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="margin:0; padding: 0 0 0 0.3em;  font-size: 0.8em;">
                        Beschränkung auf den Browser
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; margin-bottom: 0.2em; box-shadow: none">
                    </td>
                    <td style="text-align: center"><img src="pics/bubble_red.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="margin:0; padding: 0 0 0 0.3em;  font-size: 0.8em; ">
                        Web Tests (DOM basiert)
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; margin-bottom: 0.2em; box-shadow: none">
                    </td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="margin:0; padding: 0 0 0 0.3em;  font-size: 0.8em; ">
                        Open Source & Java API
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center"><img src="pics/bubble_gray.png"
                                                        style="max-height: 45px; margin-bottom: 0.2em; box-shadow: none">
                    </td>
                    <td style="text-align: center"><img src="pics/bubble_red.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="margin:0; padding: 0 0 0 0.3em;  font-size: 0.8em; vertical-align: top;">
                        Automatisierbarkeit & Ergebnisauswertung <br/>über DB / Nagios / CI-Tools
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center"><img src="pics/bubble_green.png"
                                                        style="max-height: 45px; margin-bottom: 0.2em; box-shadow: none">
                    </td>
                    <td style="text-align: center"><img src="pics/bubble_gray.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="text-align: center"><img src="pics/bubble_gray.png"
                                                        style="max-height: 45px; box-shadow: none"></td>
                    <td style="margin:0; padding: 0 0 0 0.3em;  font-size: 0.8em; vertical-align: top;">
                        Unterstützung bei Testerstellung <br/>(Recorder, Screenshot-Finder)
                    </td>
                </tr>
                </tbody>
            </table>
        </section>

        <section>
            <section>
                <h2>DEMO</h2>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/z3opwqqy3io" frameborder="0"
                        allowfullscreen></iframe>
                <p>
                    <a href="video/m-net_order_processing.wmv" target="_blank">Video File </a>
                </p>
                <!--src="pics/video_preview.png"></a>-->
            </section>
            <section>
                <h3>File Structure</h3>
                <img width="40%" class="image" src="pics/test_suite_aufbau.png">
            </section>
            <section>
                <h3 style="text-transform: inherit">Test Case Aufbau</h3>
        <pre><code class="java" data-trim contenteditable="true">
            // tc.js
            /*************************************
            * Initialization of the JAVA backend
            * and set warning and critical time
            *************************************/
            _dynamicInclude($includeFolder);
            var testCase = new TestCase(60, 70);
            var env = new Environment();
            var appNotepad = new Application("gedit");
            var region = new Region();

            /******************************
            * Description of the test case
            ******************************/
            try {

            //...

            /************************************************
            * Exception handling and shutdown of test case
            **********************************************/
            } catch (e) {
            testCase.handleException(e);
            } finally {
            testCase.saveResult();
            }
        </code></pre>
            </section>

            <section>
                <h3 style="text-transform: inherit">Aufruf von Sahi-Funktionen</h3>
        <pre><code class="java" data-trim contenteditable="true">
            // tc.js
            /************************
            * Call Sahi Functions
            ***********************/
            _navigateTo("http://labs.consol.de/lang/en");
            _highlight(_link("Projects"));
            _click(_link("Projects"));
            _highlight(_link("check_mysql_health"));
            _click(_link("check_mysql_health"));
            _highlight(_link("check_oracle_health"));
            _click(_link("check_oracle_health"));
            _setValue(_textbox("s"), "nagios");
            _click(_link("Home[1]"));
            testCase.endOfStep("project", 20);
        </code></pre>
            </section>

            <section>
                <h3 style="text-transform: inherit">Fluent API</h3>
        <pre><code class="java" data-trim contenteditable="true">
            /*** calculator app ***/
            var calculatorApp = new Application("galculator")
            .setSleepTime(1);
            .open();
            testCase.endOfStep("Open Calculator", 3);

            /**********
            * calculate 525 + 100
            *********/
            var calculatorRegion = calculatorApp.getRegion();
            calculatorRegion.type("525");
            env.sleep(2);
            calculatorRegion.find("plus.png")
            .click()
            .type("100")
            .find("calculate")
            .click();
            testCase.endOfStep("calculate 525 +100", 20);
        </code></pre>
            </section>

            <section>
                <h3 style="text-transform: inherit">Definition eines Ablaufs</h3>
        <pre><code class="java" data-trim contenteditable="true">
            // tc.js
            /************************
            * Some Variables
            ***********************/
            var $cl_home = "http://labs.consol.de/lang/en";
            var $cl_projekte = "Projects";
            var $cl_c_mysql_h = "check_mysql_health";
            var $cl_c_oracle_h = "check_oracle_health";

            /************************
            * Step for Notepad
            ***********************/
            appNotepad.open();
            env.type("Welcome to Sakuli!\n")
            .type("I will help you to test your projects, like webapplications...\n")
            .sleep(2);
            testCase.endOfStep("notepad", 20);

            /************************
            * Step for labs.consol
            ***********************/
            switchWindow();
            _navigateTo($cl_home);
            _highlight(_link($cl_projekte));
            _click(_link($cl_projekte));
            env.sleep(5)
            .takeScreenshot("C:\\sakuli\\testscreenshot.png");
            _highlight(_link($cl_c_mysql_h));
            _click(_link($cl_c_mysql_h));
            _highlight(_link($cl_c_oracle_h));
            _click(_link($cl_c_oracle_h));
            _setValue(_textbox("s"), "nagios");
            _click(_link("Home[1]"));
            testCase.endOfStep("project", 20);


            /*****************
            * print test client
            *****************/
            backToNotepad();
            env.type("I can also test client applications, like gedit...\n")
            .sleep(2);
            testCase.endOfStep("print_test_client", 10);
        </code></pre>
            </section>

            <section>
                <h3 style="text-transform: inherit">Custom Functions</h3>
        <pre><code class="java" data-trim contenteditable="true">
            // tc.js
            /**********
            * TAB+ALT
            *********/
            function switchWindow() {
            env.type(Key.TAB, Key.ALT);
            }

            /***************
            * Go back to notepad
            **************/
            function backToNotepad() {
            switchWindow();
            env.type("Finish!\n\n");
            }
        </code></pre>

            </section>
        </section>

        <section>
            <h2>Architektur</h2>
            <img width="80%" style="background: whitesmoke; border: none" src="pics/sakuli_architectur.png">
        </section>
        <section>
            <h2>Nagios Integration</h2>
            <a target="_blank"
               href="http://10.26.0.68/sakuli/thruk/#cgi-bin/extinfo.cgi?type=2&host=sahi.host.example&service=0004_calc&backend=4b2aa#pnp_th2/1406062443/1406152443">
                <img width="80%" style="border: 0" src="pics/nagios.png">
            </a>
        </section>
        <section>
            <h2>Erweiterbarkeit</h2>
            <img width="80%" style="background: whitesmoke; border: none" src="pics/kombination_with_citrus.png">
        </section>

        <section>
            <h2>Ausblick - Queue Architektur</h2>
            <ul style="font-size: 0.8em">
                <li>Skalierung durch Client-Worker-Prinzip</li>
                <li>Einfachere Wartung</li>
                <li>Zentraler Scheduler</li>
            </ul>
            <div style="height: 13em"><img style="background: whitesmoke" src="pics/queue_architecture.png">
            </div>
        </section>
        <section>
            <h2>Ausblick & Ideen</h2>
            <ul style="font-size: 0.8em; padding-top: 1em">
                <li>Headless Execution - <b>Linux:</b> xvfb & Docker, <b>Windows:</b> ?</li>
                <li><b>Video</b>-Aufzeichnung der Testabläufe zur Fehlerdokumentation</li>
                <li>Asynchrone <b>wait</b> Funktionen / Callbacks</li>
                <li>Grafische Auswertung der Testergebnisse in <b>CI-Umgebungen</b></li>
            </ul>
        </section>

        <section>
            <h1>Eure</h1>

            <h2 style="text-transform: inherit"> Ideen / Fragen?</h2>
        </section>

        <section>
            <h1>Vielen Dank!</h1>

            <div style="text-align: center; padding: 1em">
                <img src="pics/github.png" style="box-shadow: none; border: none; height: 8em">
            </div>
            <h4 style="text-transform: inherit">Support us on GitHub</h4>
            <a style="font-size: 1.5em; font-weight: bold; color: #268bd2" href="https://github.com/ConSol/sakuli"
               target="_blank">
                github.com/ConSol/sakuli
            </a>
        </section>

    </div>

</div>


<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });
</script>
</body>
</html>

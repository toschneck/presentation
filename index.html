<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description"
          content="Testing - Selenium? Rich-Clients? Containers? more information under https://github.com/ConSol/sakuli ">
    <meta name="author" content="Tobias Schneck">

    <title>Testing - Selenium? Rich-Clients? Containers?</title>

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <link rel="stylesheet" href="css/reveal.css">
    <!--<link rel="stylesheet" href="css/theme/sakuli_white.css" id="theme">-->
    <link rel="stylesheet" href="css/theme/sakuli_se_white.css" id="theme">
    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">
    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <!--<div style="text-align: left"><img src="pics/background_first_slide_top.png"-->
            <!--style="vertical-align:top; width:11em; border: 0;box-shadow: none"/>-->
            <!--</div>-->

            <h1 style="padding-top: 2em; margin-bottom: 0;text-transform: none">
                Testing
            </h1>
            <h2 style="padding-top: 1em; margin-bottom: 0;text-transform: none">
                Selenium? Rich-Clients? Containers?
            </h2>

            <!--<h2 style="padding-top: 0.2em;">-->
            <!--<img src="pics/sakuli-logo.png" style="width:5em; border: 0;box-shadow: none" alt="Sakuli">-->
            <!--+-->
            <!--<img src="pics/docker-img.jpg" style="width:5em; border: 0;box-shadow: none" alt="Docker">-->
            <!--</h2>-->

            <!-- Referent: Tobias Schneck, ConSol Software GmbH-->
            <p style="padding-top: 4.5em; text-align: right">
                <small><a href="mailto:tobias.schneck@consol.de">Tobias Schneck</a>, <a
                        href="http://www.consol.de">ConSol Software GmbH</a>
                </small>
                </br>
            </p>

            <!--<div style="text-align: right; overflow: hidden; ">-->
            <!--<img src="pics/background_first_slide_bottom.png"-->
            <!--style="vertical-align:text-bottom; width:8em; border: 0;box-shadow: none"/>-->
            <!--</div>-->
        </section>

        <section>
            <h2>During the UI development phase ...</h2>
            <img height="300px" src="pics/comic_strip/ui_button.jpg">
            <!--https://s-media-cache-ak0.pinimg.com/564x/c0/7d/30/c07d300ba6918319034230ee45418428.jpg-->
        </section>

        <section>
            <h2>Yeah - release 1.0 is out!</h2>
            <img style="margin-top: 0.5em" height="400px" src="pics/comic_strip/office_party.jpg">
            <!--http://images.nymag.com/news/features/establishments/workingfam101004_560.jpg-->
        </section>
        <section>
            <h2>Next step: <br/>Make this things perfect!</h2>
            <img style="margin-top: 0.5em" height="380px" src="pics/comic_strip/truck_cockpit_view.jpg">
            <!--http://i.imgur.com/FwITKwm.jpg-->
        </section>
        <section>
            <h3 style="line-height: 1.8">
                <ul class="red_x">
                    <li>Validate the order confirmation PDF?</li>
                    <li>Test the rich-client implementation as well?</li>
                    <li>Where to run the test?</li>
                    <li>Rewrite all of our tests?</li>
                </ul>
            </h3>
        </section>
        <section>
            <img style="margin: 1em 100px 0.7em 100px " height="380px" src="pics/comic_strip/lets-get-started.jpg">
            <ul class="arrow_right">
                <li>Generate PDF file</li>
                <li>Open the file in a native PDF viewer</li>
                <li>Validate the content</li>
            </ul>
            <!--http://i.imgur.com/FwITKwm.jpg-->
        </section>

        <section>
            <h2>Test Definition (Java)</h2>
            <!-- @formatter:off-->
                <pre><code class="java" data-trim contenteditable="false">
@Test
public void testOrderPDF() throws Exception {
    driver.get(TEST_URL);
    WebElement heading1 = driver.findElement(By.name("Cookie Bakery Application"));
    dsl.highlightElement(heading1);
    assertTrue(heading1.isDisplayed());

    WebElement download = driver.findElement(By.partialLinkText("Print PDF"));
    dsl.highlightElement(download);
    assertTrue(download.isDisplayed());
    download.click();

    //save as pdf
    screen.find("save_button.png").highlight().click();
    String pdfFilePath = "/tmp/order-confirmation.pdf";
    env.type("a", Key.CTRL) //mark filename in "save under" dialog
            .type(pdfFilePath + Key.ENTER); //type filename and press ENTER

    //open pdf and validate
    openPDF(pdfFilePath);
    screen.waitForImage("pdf_order_header", 30).highlight();
    Stream.of(
            "pdf_blueberry",
            "pdf_caramel",
            "pdf_chocolate",
            "pdf_place_order"
    ).forEach(validationPicture -> screen.find(validationPicture).highlight());
}

private Application openPDF(String pdfFilePath) {
    return pdfEditor = new Application(PDF_EDITOR_NAME + " \"" + pdfFilePath + "\"").open();
}
                       </code></pre>
        <!-- @formatter:on-->
        </section>

        <section>
            <h3 style="line-height: 1.8">
                <ul class="red_x">
                    <li class="green_hook">Validate the order confirmation PDF?</li>
                    <li>Test the rich-client implementation as well?</li>
                    <li>Where to run the test?</li>
                    <li>Rewrite all of our tests?</li>
                </ul>
            </h3>
        </section>
        <section>
            <img style="margin: 0 100px 0.7em 100px " height="350px" src="pics/comic_strip/lets-go-i-m-ready.jpg">
            <ul class="arrow_right">
                <li>Keep current tests</li>
                <li>Use same codebase</li>
                <li>Keep it simple</li>
            </ul>
        </section>
        <section>
            <h2 style="padding-bottom: 0">Add Maven Dependencies</h2>
            <!-- @formatter:off-->
                <pre><code class="xml" data-trim contenteditable="false">
    <dependencies>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-server</artifactId>
            <version>3.0.1</version>
        </dependency>
        <dependency>
            <groupId>org.sakuli</groupId>
            <artifactId>selenium-java-dsl</artifactId>
            <version>${sakuli.version}</version>
            <type>jar</type>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>6.8.8</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <!-- ConSol Labs repository holds the Sakuli libraries-->
    <repositories>
        <repository>
            <id>labs-consol</id>
            <name>ConSol* Labs Repository</name>
            <url>http://labs.consol.de/maven/repository</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
            <releases>
                <enabled>true</enabled>
            </releases>
        </repository>
    </repositories>
               </code></pre>
            <!-- @formatter:on-->
        </section>
        <section>
            <h2>Extend from class AbstractSakuliSeTest</h2>
            <!-- @formatter:off-->
                <pre><code class="java" data-trim contenteditable="false">
public class BakeryOrderConfirmationTest extends AbstractSakuliSeTest {

    private static final String TEST_URL = "http://bakery-web-server:8080/bakery/";
    private static final String PDF_EDITOR_NAME = "masterpdfeditor4";
    private Application pdfEditor;

    @Override
    protected TestCaseInitParameter getTestCaseInitParameter() throws Exception {
        //specifies the resource folder for the screenshots
        return new TestCaseInitParameter("bakery_test");
    }

    @AfterMethod
    @Override
    public void saveTcStep() throws Throwable {
        super.saveTcStep();
        pdfEditor.closeApp();
    }

    // will be used in each test case step
    private Application openPDF(String pdfFilePath) {
       return pdfEditor = new Application(PDF_EDITOR_NAME + " \"" + pdfFilePath + "\"").open();
    }
}
               </code></pre>
          <!-- @formatter:on-->
        </section>

        <section>
            <h3 style="line-height: 1.8">
                <ul class="red_x">
                    <li class="green_hook">Validate the order confirmation PDF?</li>
                    <li>Test the rich-client implementation as well?</li>
                    <li>Where to run the test?</li>
                    <li class="green_hook">Rewrite all of our tests?</li>
                </ul>
            </h3>
        </section>

        <section>
            <img style="margin: 1em 100px 0.7em 100px " height="380px" src="pics/comic_strip/lets-go-guys.jpg">
            <ul class="arrow_right">
                <li>Make an order at the web client</li>
                <li>Trigger the reporting function in the rich client</li>
                <li>Validate the reported count of produces orders</li>
            </ul>
        </section>

        <section>
            <h2>Control Web and Rich Clients</h2>
            <!-- @formatter:off-->
                <pre><code class="java" data-trim contenteditable="false">
@Test
public void testWebOrderToReportClient() throws Exception {
    driver.get(TEST_URL);
    WebElement heading1 = driver.findElement(By.name("Cookie Bakery Application"));
    assertTrue(heading1.isDisplayed());

    WebElement order = driver.findElement(By.cssSelector("button blueberry-order"));
    assertTrue(order.isDisplayed());
    for (int i = 0; i < 20; i++) {
        LOGGER.info("place blueberry order " + i);
        order.click();
    }

    //open native client application over $PATH
    reportClient = new Application("baker-report-client").open();
    Region reportClientRegion = reportClient.getRegion();

    //generate the report
    reportClientRegion.type("r", Key.ALT); //type ALT + r to open the report view
    reportClientRegion.find("get-daily-report-button").click();
    reportClientRegion.waitForImage("report-header", 10);
    try {
        reportClientRegion.find("blueberry_muffin_logo");
        reportClientRegion.find("report_blueberry");
        reportClientRegion.find("report_blueberry").below(100).find("report_value_20");
    } catch (Exception e) {
        //useful for custom error messaten
        throw new SakuliException("Validation of the report client failed"
                    + " - no muffins produced?");
    }
}
               </code></pre>
          <!-- @formatter:on-->
        </section>

        <section>
            <h3 style="line-height: 1.8">
                <ul class="green_hook">
                    <li>Validate the order confirmation PDF?</li>
                    <li>Test the rich-client implementation as well?</li>
                    <li class="red_x">Where to run the test?</li>
                    <li>Rewrite all of our tests?</li>
                </ul>
            </h3>
        </section>


        <section>
            <img style="margin: 0 100px 0.7em 100px " height="380px" src="pics/comic_strip/lets-go-team.jpg">
            <ul class="arrow_right">
                <li>Run all UI tests in the container</li>
                <li>Make it scalable for parallel execution</li>
                <li>Keep the possibility to "watch" the test</li>
                <li>Should be triggered by the CI server</li>
                <li>Use our internal private cloud infrastructure</li>
            </ul>
        </section>


        <section>
            <h2>We need a containerized GUI! </h2>
            <div style="margin-top: 2em">
                <img width="100%" style="box-shadow: none" src="pics/container_sakuli.png">
            </div>
        </section>

        <section>
            <a target="_blank" href="video/sakuli_containers.mp4">
                <h2>Let's try the Sakuli Container</h2>
            </a>

            <!-- @formatter:off-->
            <div data-markdown contenteditable="false">
```bash
# start the docker container
docker run -it -p 5911:5901 -p 6911:6901 consol/sakuli-ubuntu-xfce
docker run -it -p 5912:5901 -p 6912:6901 consol/sakuli-centos-xfce
docker run -it -p 5913:5901 -p 6913:6901 consol/sakuli-ubuntu-xfce-java
docker run -it -p 5914:5901 -p 6914:6901 consol/sakuli-centos-xfce-java

# start in parallel via docker-compose
# use docker-compos.yml from https://github.com/ConSol/sakuli/tree/master/docker
docker-compose up
```
</div>
            <!-- @formatter:on-->
            <div style="padding-top: 0.4em;">
                <a target="_blank"
                   href="vnc_overview_local.html">
                    <img width="47%" style="box-shadow: none;" src="pics/docker_sakuli_example.png">
                </a>
            </div>
        </section>


        <section>
            <h2>Mount and Run the Testsuite</h2>
            <!-- @formatter:off-->
            <div data-markdown contenteditable="false">
```yml
# docker-compose.yml
version: '2'
                
services:
  sakuli_se_bakery_test:
    image: consol/sakuli-ubuntu-xfce-java
    environment:
    - TZ=Europe/Berlin
    volumes:
    - .:/opt/maven
    - data:/root/.m2
    network_mode: "bridge"
    ports:
    - 5911:5901    # VNC port
    - 6911:6901    # webVNC port
    # to keep container running and login via `docker exec -it [image_name] bash`
    #command: "'--tail-log'"

volumes:
  data:
    driver: local
```
        </div>
        <div data-markdown contenteditable="false">
```bash
# start it from the command line
docker-compose up
```
        </div>
            <!-- @formatter:on-->
        </section>
        <section>
            <h2 style="padding-bottom: 0">Bakery Demo Setup</h2>

            <a href="https://github.com/toschneck/sakuli-example-bakery-testing" target="_blank">
                <img width="90%"
                     style="border: none"
                     src="pics/ci_umgebung.png"/>
            </a>
        </section>
        <section>
            <h2 style="padding-bottom: 0">Bakery Demo Setup</h2>
            <a href="https://github.com/toschneck/sakuli-example-bakery-testing" target="_blank">
                <img width="90%"
                     style="border: none"
                     src="pics/ci_umgebung_2.png"/>
            </a>
        </section>
        <section>
            <a target="_blank" href="video/sakuli_ci_cm6_demo.mp4">
                <h2>Bakery Demo</h2>
            </a>

            <!-- @formatter:off-->
            <div data-markdown contenteditable="false">
```bash
git clone https://github.com/toschneck/sakuli-example-bakery-testing.git

# start jenkins
jenkins/deploy_jenkins.sh
# start OMD montioring
omd-nagios/deploy_omd.sh

# start the build of the application images
bakery-app/app-deployment-docker-compose/deploy_app.sh

#start tests
sakuli-tests/execute_all.sh
#start tests for monitoring
sakuli-tests/execute_all_4_monitoring.sh

# for OpenShift deploy configuration, see READE.md
openshift/build_and_deploy_all.sh
```
</div>
            <!-- @formatter:on-->
            <div style="padding-top: 0.5em"></div>
            <table width="90%">
                <tr>
                    <td width="50%">
                        <a target="_blank" href="vnc_overview_local.html">
                            <img style="box-shadow: none;padding-right: 0.5em; width: 100%"
                                 src="pics/ci_bakery_test.png">
                        </a>
                    </td>
                    <td style="vertical-align: top; text-align: right;padding-top: 0.4em;" width="50%">
                        <a target="=_blank" href="http://localhost:8080/">
                            <img style="box-shadow: none; width: 100%"
                                 src="pics/ci_jenkins_pipeline.png">
                        </a>
                    </td>
                </tr>
            </table>
        </section>

        <!--TODO TS: maybe add it-->
        <!--<section>-->
            <!--<h2 style="margin-bottom: 0.2em; padding-bottom: 0.3em"><img style="height: 1.5em;box-shadow: none"-->
                                                                         <!--src="pics/sakuli-logo.png"/>-->
                <!--Monitoring Integration</h2>-->
            <!--<div style="font-size: x-large">-->
                <!--<img style="margin-left: 1em;box-shadow: none" src="css/theme/pics/green_hook_list.png">-->
                <!--Nagios-->
                <!--<img style="margin-left: 1em;box-shadow: none" src="css/theme/pics/green_hook_list.png">-->
                <!--OMD-->
                <!--<img style="margin-left: 1em;box-shadow: none" src="css/theme/pics/green_hook_list.png">-->
                <!--Incinga-->
                <!--<img style="margin-left: 1em;box-shadow: none" src="css/theme/pics/green_hook_list.png">-->
                <!--Check_MK-->
            <!--</div>-->
            <!--<a target="_blank" href="https://github.com/ConSol/sakuli/blob/master/docs/index.md">-->
                <!--<img width="85%" style="border: 0; margin-top: 0.7em" src="pics/nagios.png">-->
            <!--</a>-->
        <!--</section>-->

        <section>
            <h2>What's next?</h2>
            <ul style="font-size: 0.8em; padding-top: 1em">
                <li>Headless execution -
                    <b>Linux:</b>
                    VNC & Docker
                    <img style="box-shadow: none" src="css/theme/pics/green_hook_list.png"/>
                    <b>Windows:</b> <b style="color: red; font-size: 1.3em">?</b>
                </li>
                <li><b>Video</b> recording of the test execution (error documentation)</li>
                <li><b>Web UI</b> to handle Sakuli test suites</li>
                <li>Connect 3rd-party <b>test management tools</b> (HP QC, TestRail, ...)</li>
                <li>Improve test <b>result presentation</b> in CI tools</li>
                <li>Implement <b>Junit 5</b> test runner</li>
            </ul>
        </section>


        <section>
            <h2>Links</h2>

            <table style="font-size: 0.8em; padding-top: 0.5em">
                <tr>
                    <td>
                        <img src="pics/github.png" style="box-shadow: none; height: 5em">
                    </td>
                    <td style="vertical-align: middle;  white-space:nowrap; padding-left: 1.5em">
                        <a href="https://github.com/ConSol/sakuli" target="_blank">
                            <img src="pics/github-mark.png" style="box-shadow: none; height: 35px"><b
                                style="padding-left: 0.8em">ConSol/sakuli</b>
                        </a>
                        <br/>

                        <div style="padding-top: 0.5em"></div>
                        <a href="https://github.com/consol/sakuli-examples" target="_blank">
                            <img src="pics/github-mark.png" style="box-shadow: none; height: 35px"><b
                                style="padding-left: 0.8em">ConSol/sakuli-examples</b>
                        </a> <br/>

                        <div style="padding-top: 0.5em"></div>
                        <a href="https://github.com/toschneck/sakuli-example-bakery-testing" target="_blank">
                            <img src="pics/github-mark.png" style="box-shadow: none; height: 35px"><b
                                style="padding-left: 0.8em">toschneck/sakuli-example-bakery-testing</b>
                        </a>
                    </td>
                </tr>
                <tr>
                    <td/>
                    <td style="padding-left: 1.5em">
                        <div style="padding-top: 0.5em"></div>
                        <a href="mailto:sakuli@consol.de">
                            <img src="pics/mail_logo.png" style="box-shadow: none; height: 1.3em">
                            <b>sakuli@consol.de</b>
                        </a>
                        <!--<div style="padding-top: 0.2em">-->
                        <a href="https://twitter.com/sakuli_e2e">
                            <img src="pics/twitter_bird_logo_.png"
                                 style="padding-left:40px;box-shadow: none; height: 1em">
                            <b>@sakuli_e2e</b>
                        </a>
                        <!--</div>-->

                        <div style="padding-top: 2em"></div>
                        <a href="https://www.informatik-aktuell.de/entwicklung/methoden/graphical-user-interface-gui-in-containern-testen.html"
                           target="_blank">
                            <img src="pics/ia_artikel.png" style="margin-left:6px; padding: 10px 22px 10px 22px;" ;
                                 width="600px">
                        </a>
                    </td>
                </tr>
            </table>
        </section>

        <section>
            <h1 class="coloured" style="text-transform: inherit">Thank you!</h1>

            <table style="font-size: large;margin-top: 3.5em" width="50%">
                <tr>
                    <td style="text-align: center">
                        <img style="box-shadow: none"
                             src="pics/profil_pic_sakuli.jpg">
                    </td>
                    <td style="padding-right: 1.5em"></td>
                    <td style="vertical-align: middle">
                        <table style="display: block">
                            <tr>
                                <td><b>Tobias Schneck</b></td>
                            </tr>
                            <tr>
                                <td>
                                    <a style="float: left; padding-right: 1em" href="mailto:tobias.schneck@consol.de"
                                       target="_blank">tobias.schneck@consol.</a>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding-top: 0.2em">
                                    <a href="https://twitter.com/toschneck" target="_blank">
                                        <img src="pics/twitter_toschneck.png" style="box-shadow: none; height: 22px">
                                    </a>
                                    <a style="padding-left: 1em" href="https://github.com/toschneck" target="_blank">
                                        <img src="pics/github-mark.png" style="box-shadow: none; height: 22px"><b
                                            style="padding-left: 0.4em; font-size: medium">toschneck</b>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center;vertical-align: top">
                        <img src="pics/consol_c.png"
                             style="padding-top: 3em; height: 5em; box-shadow: none;float: none">
                    </td>
                    <td/>
                    <td style="padding-top: 3em; vertical-align: middle">
                        <table style="display: block; white-space:nowrap">
                            <tr>
                                <td colspan="2"><b>ConSol Software GmbH</b></td>
                            </tr>
                            <tr>
                                <td colspan="2">Franziskanerstraße 38</td>
                            </tr>
                            <tr>
                                <td colspan="2">D-81669 München</td>
                            </tr>
                            <tr>
                                <td style="padding-right: 1em">Tel: +49-89-45841-100</td>
                                <td><a href="mailto:info@consol.de">info@consol.de</a></td>
                            </tr>
                            <tr>
                                <td style="padding-right: 1em">Fax: +49-89-45841-111</td>
                                <td><a href="http://www.consol.de">www.consol.de</a></td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding-top: 0.2em">
                                    <a href="https://twitter.com/consol_de" target="_blank">
                                        <img src="pics/twitter_consol_de.png" style="box-shadow: none; height: 22px">
                                    </a>
                                    <a style="padding-left: 1em" href="https://github.com/consol" target="_blank">
                                        <img src="pics/github-mark.png" style="box-shadow: none; height: 22px"><b
                                            style="padding-left: 0.4em; font-size: medium">ConSol</b>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </section>

    </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: false,
        progress: true,
        history: true,
        center: true,
        touch: true,
        hideAddressBar: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Slide number formatting can be configured using these variables:
        //  h: current slide's horizontal index
        //  v: current slide's vertical index
        //  c: current slide index (flattened)
        //  t: total number of slides (flattened)
//        slideNumber: 'c / t',
        slideNumber: 'c',


        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

    //custom added functionality
    isPrintingPdf = function () {
        return ( /print-pdf/gi ).test(window.location.search);
    }
    Reveal.showControls = function () {
        if (Reveal.isFirstSlide()) {
            Reveal.configure({controls: false});
        } else {
            Reveal.configure({controls: true});
        }
    };

    if (isPrintingPdf()) {
        console.log("PDF - no control functions!");
    } else {
        console.log("NO PDF - override control functions!");
        Reveal.addEventListener('slidechanged', function (event) {
            Reveal.showControls();
        });
        Reveal.showControls();
    }
</script>
</body>
</html>
